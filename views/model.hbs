<div id="fade" class="popupOverlay"></div>
<div class="admin-panel clearfix">
    <div class="slidebar">
        <div class="logo">
            <a href=""></a>
        </div>
        <ul>
            <li class="drop">
                <a href="#dashboard" class="dropTitle"><i class="fa fa-folder-o static" aria-hidden="true"></i>
                    Physiology<i class="fa fa-angle-up dynamic"></i>
                </a>
                <ul class="subMenu active">
                    <li><a href="#dashboard" id="targeted"><i class="fa fa-picture-o static"
                                aria-hidden="true"></i>Reaction
                            Diagram</a></li>
                    <li><a href="#reactions"><i class="fa fa-flask static" aria-hidden="true"></i>Reactions</a>
                    </li>
                    <li><a href="#structures"><i class="fa fa-codepen static" aria-hidden="true"></i>Structures</a>
                    </li>
                    <li><a href="#species"><i class="fa fa-link static" aria-hidden="true"></i>
                            Species</a>
                    </li>
                    <li><a href="#molecules"><i class="fa fa-empire static" aria-hidden="true"></i>Molecules</a>
                    </li>
                    <li><a href="#observables"><i class="fa fa-eercast static" aria-hidden="true"></i>Observables</a>
                    </li>
                </ul>
            </li>
            <li class="drop">
                <a href="#applications" class="dropTitle"><i class="fa fa-folder-o static" aria-hidden="true"></i>
                    Applications <i class="fa fa-angle-down dynamic"></i>
                </a>
                <ul class="subMenu">
                    {{#each data.vcml.BioModel}}
                    {{#each this.SimulationSpec as |value key|}}
                    <li class="drop child">
                        <a href="#specsSpecies{{key}}" class="dropTitle"><i class="fa fa-folder-o static"
                                aria-hidden="true"></i>
                            <span class="wordLimit">{{value.$.Name}}</span><i class="fa fa-angle-down dynamic"></i>
                        </a>
                        <ul class="subMenu">
                            <li><a href="#specsSpecies{{key}}"><i class="fa fa-pencil-square-o static"
                                        aria-hidden="true"></i>Specs - Species</a></li>
                            <li><a href="#specsReaction{{key}}"><i class="fa fa-pencil-square-o static"
                                        aria-hidden="true"></i>Specs - Reactions</a></li>
                            <li><a href="#simulations{{key}}"><i class="fa fa-superpowers static"
                                        aria-hidden="true"></i>Simulations</a></li>
                        </ul>
                    </li>
                    {{/each}}
                    {{/each}}
                </ul>
            </li>
            <li class="drop">
                <a href="#global" class="dropTitle"><i class="fa fa-globe static" aria-hidden="true"></i>
                    Global Parameters
                </a>
            </li>
            <li class="drop">
                <a href="#downloads" class="dropTitle"><i class="fa fa-globe static" aria-hidden="true"></i>
                    Downloads
                </a>
            </li>
        </ul>
    </div>

    <div class="main">
        <ul class="topbar clearfix">
            {{#each data.vcml.BioModel}}
            {{#each this.Version}}
            <li><a id="modelName" href="#dashboard">{{trimString this.$.Name}} -
                    {{this.$.KeyValue}}</a></li>
            <li class="printable"><a href="/curatedList/printModel/{{this.$.Name}}"><i class="fa fa-print"
                        aria-hidden="true"></i></a>
            </li>

            {{!-- var define for downloads section. used in main.js file. --}}
            <li style="display: none"><a id="selectedModel">{{this.$.Name}}</a></li>

            {{/each}}
            {{/each}}
        </ul>
        <!-- <div class="landingContent">
          <h2>Landing content</h2>
        </div> -->
        <div class="mainContent clearfix">
            <div id="physiology" class="optionData">
                <h2 class="header">Physiology</h2>

            </div>

            {{!-- Reaction Diagram  --}}
            <div id="dashboard" class="optionData">
                <h2 class="header"><span class="icon"></span>Reaction Diagram</h2>
                <div class="reactionDiagram" id="diagram">
                    {{#each data.vcml.BioModel}}
                    {{#each this.Version}}
                    <img src="https://vcellapi-beta.cam.uchc.edu:8080/biomodel/{{this.$.KeyValue}}/diagram"
                        alt="reactionDiagram" draggable="false" />
                    {{/each}}
                    {{/each}}

                </div>

                {{!--info Reaction Diagram--}}

                <div class="box-diagram">
                    <div class='textWrap'>
                        <div class="publications" id="globalPublications" onclick="test(BioModel)">
                            <h2>Cross-References</h2>

                        </div>
                        <div class="annotations" id="globalAnnotations">
                            <h2>Annotations</h2>
                        </div>
                    </div>
                </div>

                {{!-- popup --}}
            </div>

            {{!-- Rections Table  --}}
            <div id="reactions" class="optionData">
                <h2 class="header">Reactions</h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Reactions">Reactions
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Reactions', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Reactions', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Structure">Structure
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Structure', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Structure', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Kinetics">Kinetics
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Kinetics', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Kinetics', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each data.vcml.BioModel}}
                            {{#each this.Model}}
                            {{#each this.SimpleReaction as |value key|}}
                            <tr>
                                <td data-label="Reactions" class="Reactions">
                                    {{#each value.Reactant}}
                                    {{nullCheck this.$.LocalizedCompoundRef}}
                                    {{/each}}
                                    <span><i class="fa fa-long-arrow-right" aria-hidden="true"></i></span>
                                    {{#each value.Product}}
                                    {{this.$.LocalizedCompoundRef}}
                                    {{/each}}
                                </td>
                                <td data-label="Name" class="Name"><a id={{value.$.Name}} onClick="reply_click(this.id)"
                                        style="cursor:pointer; color:#3EB9FE">{{value.$.Name}}</a></td>
                                <td data-label="Structure" class="Structure">{{value.$.Structure}}</td>
                                {{#each value.Kinetics}}
                                <td data-label="Kinetics" class="Kinetics"><a id="{{key}}"
                                        onClick="reply_click(this.id)"
                                        style="cursor:pointer; color:#3EB9FE">{{this.$.KineticsType}}</a></td>
                                {{/each}}</td>
                            </tr>

                            {{/each}}
                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
                {{!-- popup reactions --}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.SimpleReaction as |value key|}}
                <div class="popup box-{{value.$.Name}}">
                    <div class='popup-text'>


                        {{!-- universal ID's  --}}
                        <div class="uid" id="reactionUID-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="reactionTA-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>


                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}
                {{/each}}
                {{!-- popup --}}
                {{!-- popup reactions Expressions--}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.SimpleReaction as |value key|}}
                {{#each value.Kinetics}}
                <div class="popup box-{{key}}">
                    <div class='popup-text block'>
                        {{!-- Expressions --}}
                        <h2 id="reactionNameExp">Expressions for {{value.$.Name}}</h2>


                        {{#each this.Parameter}}

                        <div class="role">
                            <p class="role-title">{{this.$.Role}}</p>
                            <p class="role-variable">{{this.$.Name}}</p>
                            <p class="role-text">{{this._}} <span class="unit">[{{this.$.Unit}}]</span> </p>
                        </div>
                        {{/each}}
                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}
                {{/each}}
                {{/each}}
                {{!-- popup --}}
            </div>

            {{!-- Structures Table  --}}
            <div id="structures" class="optionData">
                <h2 class="header">Structures</h2>
                <div class="modelTable">
                    <!---should be id="content-table3" below, using test for js "getElementById()"--->
                    <table id="TEST" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Type">Type
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Type', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Type', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Electrical">Electrical
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Electrical', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Electrical', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each data.vcml.BioModel}}
                            {{#each this.Model}}
                            {{#each this.Membrane}}
                            <tr>
                                <td data-label="Name" class="Name"><a id={{this.$.Name}} onClick="reply_click(this.id)"
                                        style="cursor:pointer; color:#3EB9FE">{{this.$.Name}}</a></td>
                                <td data-label="Type" class="Type">Membrane</td>
                                <td data-label="Electrical" class="Electrical">
                                    {{this.$.PositiveFeature}}(+) &nbsp; {{this.$.NegativeFeature}}(-)
                                </td>
                            </tr>

                            {{/each}}
                            {{#each this.Feature}}
                            <tr>
                                <td data-label="Name" class="Name"><a id={{this.$.Name}} onClick="reply_click(this.id)"
                                        style="cursor:pointer; color:#3EB9FE">{{this.$.Name}}</a></td>
                                <td data-label="Type" class="Type">Compartment</td>
                                <td data-label="Electrical" class="Electrical">
                                    {{this.$.PositiveFeature}}(+) &nbsp; {{this.$.NegativeFeature}}(-)
                            </tr>
                            {{/each}}
                            {{/each}}
                            {{/each}}


                        </tbody>
                    </table>
                </div>

                {{!-- popup structures membrane--}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.Membrane as |value key|}}
                <div class="popup box-{{value.$.Name}}">
                    <div class='popup-text'>

                        {{!-- universal ID's  --}}
                        <div class="uid" id="structureUID-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="structureTA-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>

                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}
                {{/each}}
                {{!-- popup --}}

                {{!-- popup structures features --}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.Feature as |value key|}}
                <div class="popup box-{{value.$.Name}}">
                    <div class='popup-text'>
                        <!---removed: to save space <h3>Structure Name: <span>{{value.$.Name}}</span></h3>--->
                        {{!-- universal ID's  --}}
                        <div class="uid" id="structureUID-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="structureTA-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>
                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}
                {{/each}}
                {{!-- popup --}}
            </div>

            {{!-- Species table  --}}
            <div id="species" class="optionData">
                <h2 class="header">Species</h2>
                <div class="modelTable">
                    <table id="content-table3-species" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3-species');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3-species');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Structure">Structure
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Structure', 'content-table3-species');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Structure', 'content-table3-species');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Structure">BioNetGen Definition
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Structure', 'content-table3-species');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Structure', 'content-table3-species');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Structure">Depiction
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Structure', 'content-table3-species');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Structure', 'content-table3-species');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>

                            </tr>
                        </thead>
                        <tbody>
                            {{#each data.vcml.BioModel}}
                            {{#each this.Model}}
                            {{#each this.LocalizedCompound}}
                            <tr>
                                <td data-label="Name" class="Name"><a id={{this.$.Name}} onClick="reply_click(this.id)"
                                        style="cursor:pointer; color:#3EB9FE">{{this.$.Name}}</a></td>
                                <td data-label="Structure" class="Structure">{{this.$.Structure}}</td>
                                <td data-label="Structure" class="Structure">{{#each this.SpeciesPattern}}{{#each this.MolecularTypePattern}}{{#each this.MolecularType}}{{this.$.Name}}({{/each}}{{#each this.ComponentPattern}}{{this.$.MolecularComponent}}{{#this.$.ComponentStatePattern}}~{{this}}{{/this.$.ComponentStatePattern}}!{{this.$.BondType}}{{!--this.$.BondType--}}{{/each}}).{{/each}}{{/each}}</td>
                                <td data-label="Structure" class="Structure">
                                  <canvas id="{{this.$.Name}}_species_canvas" class="molecule_canvas" width="185" height="68"></canvas>
                                </td>
                            </tr>
                            {{/each}}
                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
                {{!-- popup Species --}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.LocalizedCompound as |value key|}}
                <div class="popup box-{{value.$.Name}}">
                    <div class='popup-text'>
                        {{!-- universal ID's  --}}
                        <div class="uid" id="speciesUID-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="speciesTA-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>

                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}
                {{/each}}
                {{!-- popup --}}
            </div>

            {{!-- Molecules table  --}}
            <div id="molecules" class="optionData">
                <h2 class="header">Molecules</h2>
                <div class="modelTable">
                    <table id="content-table3-molecules" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Description">BioNetGen Definition
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Description', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Description', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Description">DEPICTION
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Description', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Description', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each data.vcml.BioModel}}
                            {{#each this.Model}}
                            {{#each this.RbmModelContainer}}
                            {{#each this.MolecularTypeList}}
                            {{#each this.MolecularType}}

                            <tr>
                                <td data-label="Name" class="Name"><a id={{this.$.Name}} onClick="reply_click(this.id)"
                                        style="cursor:pointer; color:#3EB9FE">{{this.$.Name}}</a></td>

                                <td data-label="Description" class="Description">{{this.$.Name}}({{#each this.MolecularComponent}}{{this.$.Name}}{{#each AllowableState}}~{{this.$.Name}}{{/each}}{{/each}})</td>

                                <td data-label="Depiction" class="Depiction">
                                  <canvas id="{{this.$.Name}}_molecules_canvas" class="molecule_canvas" width="185" height="68"></canvas>
                                </td>
                            </tr>
                            {{/each}}{{/each}}{{/each}}{{/each}}{{/each}}
                        </tbody>
                    </table>
                </div>
                {{!-- popup Molucules --}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.RbmModelContainer}}
                {{#each this.MolecularTypeList}}
                {{#each this.MolecularType as |value key|}}
                <div class="popup box-{{value.$.Name}}">
                    <div class='popup-text'>

                        {{!-- universal ID's  --}}
                        <div class="uid" id="moleculesUID-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="moleculeTA-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>

                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}
                {{/each}}
                {{/each}}
                {{/each}}
                {{!-- popup --}}
            </div>

            {{!-- Observables table  --}}
            <div id="observables" class="optionData">
                <h2 class="header">Observables</h2>
                <div class="modelTable">
                    <table id="content-table3-observables" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Structure">Structure
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Structure', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Structure', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Domain">Domain
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Domain', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Domain', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="MolecularType">BNGL Definition
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'MolecularType', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'MolecularType', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="SequenceType">Sequence Type
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'SequenceType', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'SequenceType', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Depiction">DEPICTION
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'SequenceType', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'SequenceType', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>

                            </tr>
                        </thead>
                        <tbody>
                            {{#each data.vcml.BioModel}}
                            {{#each this.Model}}
                            {{#each this.RbmModelContainer}}
                            {{#each this.RbmObservableList}}
                            {{#each this.Observable}}

                            <tr>
                                <td data-label="Name" class="Name"><a id={{this.$.Name}} onClick="reply_click(this.id)"
                                        style="cursor:pointer; color:#3EB9FE">{{this.$.Name}}</a></td>
                                <td data-label="Structure" class="Structure">{{this.$.Structure}}</td>
                                <td data-label="Domain" class="Domain">{{this.$.ObservableType}}</td>
                                {{#each this.SpeciesPattern}}
                                {{#each this.MolecularTypePattern}}
                                <td data-label="MolecularType" class="MolecularType">{{#each this.MolecularType}}{{this.$.Name}}{{/each}}()</td>
                                {{/each}}
                                {{/each}}
                                <td data-label="SequenceType" class="SequenceType">{{this.$.Sequence}}</td>

                                <td>
                                  <canvas id="{{this.$.Name}}_observables_canvas" class="molecule_canvas" width="185" height="68"></canvas>
                                </td>

                            </tr>

                            {{/each}}
                            {{/each}}
                            {{/each}}
                            {{/each}}
                            {{/each}}

                        </tbody>
                    </table>
                </div>

                {{!-- popup Observables --}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.RbmModelContainer}}
                {{#each this.RbmObservableList}}
                {{#each this.Observable as |value key|}}
                <div class="popup box-{{value.$.Name}}">
                    <div class='popup-text'>

                        {{!-- universal ID's  --}}
                        <div class="uid" id="observableUID-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="observableTA-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>

                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}
                {{/each}}
                {{/each}}
                {{/each}}
                {{!-- popup --}}
            </div>

            {{!-- Applications Table  --}}
            <div id="applications" class="optionData">
                <h2 class="header">Applications</h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="properties">Properties
                                </th>
                                <th class="Type">Math Type
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Type', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Type', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>

                            {{#each data.vcml.BioModel}}
                            {{#each this.SimulationSpec as |value key|}}
                            <tr>
                                <td data-label="Name" class="Name"><a id={{this.$.Name}} onClick="reply_click(this.id)"
                                        style="cursor:pointer; color:#3EB9FE">{{this.$.Name}}</a></td>
                                <td data-label="properties" class="properties">
                                    <a href="#specsSpecies{{key}}" style="cursor:pointer; color:#3EB9FE">Specs -
                                        Species</a> <br>
                                    <a href="#specsReaction{{key}}" style="cursor:pointer; color:#3EB9FE">Specs -
                                        Reaction</a> <br>
                                    <a href="#simulations{{key}}" style="cursor:pointer; color:#3EB9FE">Simulations</a>
                                </td>
                                <td data-label="Type" class="Type" id="mathType"></td>
                            </tr>

                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
                {{!-- popup applications --}}
                {{#each data.vcml.BioModel}}
                {{#each this.SimulationSpec as |value key|}}
                <div class="popup box-{{value.$.Name}}">
                    <div class='popup-text block'>
                        <div class="role">
                          {{!-- annotation --}}
                          <h2>{{value.$.Name}} Text Annotations</h2>
                          {{!-- universal ID's  --}}
                          <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        <div class="role">
                          <p>Annotations will come here</p>
                          <p>RFID | pubmed</p>
                        </div>
                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}

                {{!-- popup --}}
            </div>

            {{!-- for each application  --}}
            {{#each data.vcml.BioModel}}
            {{#each this.SimulationSpec as |value key|}}
            {{!-- specifications - Species table  --}}
            <div id="specsSpecies{{key}}" class="optionData">
                <h2 class="header">Specifications (Species) - {{value.$.Name}} <span class="propertyBtn"><a
                            href="#simulations{{key}}">go to
                            Simulations</a></span> </h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Species">Species
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Species', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Species', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>

                                <th class="Initial">Initial Condition
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Initial', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Initial', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Diffusion">Diffusion Constant
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Diffusion', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Diffusion', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each this.ReactionContext}}
                            {{#each this.LocalizedCompoundSpec}}
                            <tr>
                                <td data-label="Species" class="Species">
                                  {{this.$.LocalizedCompoundRef}}
                                </td>
                                <td data-label="Initial" class="Initial">
                                  {{this.InitialConcentration}}
                                </td>
                                <td data-label="Diffusion" class="Diffusion">
                                  {{this.Diffusion}}
                                </td>
                            </tr>
                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
            </div>
            {{!-- specifications - Reaction table  --}}
            <div id="specsReaction{{key}}" class="optionData">
                <h2 class="header">Specifications (Reaction) - {{value.$.Name}} <span class="propertyBtn"><a
                            href="#simulations{{key}}">go to
                            Simulations</a></span> </h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>

                                <th class="ReactionMapping">Enabled?
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'ReactionMapping', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'ReactionMapping', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>

                            {{#each value.ReactionContext}}
                            {{#each this.ReactionSpec}}
                            <tr>
                                <td data-label="Name" class="Name">{{this.$.ReactionStepRef}}</td>
                                <td data-label="ReactionMapping" class="ReactionMapping">{{this.$.ReactionMapping}}</td>
                            </tr>

                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
            </div>

            {{!-- simulations table  --}}
            <div id="simulations{{key}}" class="optionData">
                <h2 class="header">Simulations - {{value.$.Name}} <span class="propertyBtn"><a
                            href="#specifications{{key}}">go to
                            Specifications</a></span></h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="endTime">End Time
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'endTime', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'endTime', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Output">Output Options
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Output', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Output', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each value.Simulation}}
                            <tr>
                                <td data-label="Name" class="Name"><a id={{this.$.Name}} onClick="reply_click(this.id)"
                                        style="cursor:pointer; color:#3EB9FE">{{this.$.Name}}</a></td>
                                {{#each this.SolverTaskDescription}}
                                {{#each this.TimeBound}}
                                <td data-label="endTime" class="endTime">{{ this.$.EndTime}}
                                </td>
                                {{/each}}
                                {{#each this.OutputOptions}}
                                <td data-label="Output" class="Output">every {{ this.$.OutputTimeStep}}</td>
                                {{/each}}
                                {{/each}}
                            </tr>
                            {{/each}}
                        </tbody>
                    </table>
                </div>
                {{!-- popup Simulations --}}
                {{#each value.Simulation}}
                <div class="popup box-{{this.$.Name}}">
                    <div class='popup-text'>
                        {{!-- universal ID's  --}}
                        <div class="uid" id="UID-{{this.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="TA-{{this.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>

                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>

                {{/each}}
                {{!-- popup --}}
            </div>
            {{/each}}
            {{/each}}


            {{!-- Gloabal Parameters --}}
            <div id="global" class="optionData">
                <h2 class="header">Global Parameters</h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name globalParameterName">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Expression">Expression
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Expression', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Expression', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each data.vcml.BioModel}}
                            {{#each this.Model}}
                            {{#each this.ModelParameters}}
                            {{#each this.Parameter}}
                            <tr>
                                <td data-label="Name" class="Name"><a id={{this.$.Name}} onClick="reply_click(this.id)"
                                        style="cursor:pointer; color:#3EB9FE">{{this.$.Name}}</a></td>
                                <td data-label="Expression" class="Expression">{{this._}}<span
                                        class="unit">[{{this.$.Unit}}]</span></td>
                            </tr>
                            {{/each}}
                            {{/each}}
                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
                {{!-- popup parameters --}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.ModelParameters}}
                {{#each this.Parameter}}
                <div class="popup box-{{this.$.Name}}">
                    <div class='popup-text'>

                        {{!-- universal ID's  --}}
                        <div class="uid" id="parameterUID-{{this.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="parameterTA-{{this.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>

                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>

                {{/each}}
                {{/each}}
                {{/each}}
                {{/each}}

                {{!-- popup --}}
            </div>

            {{!-- Downloads --}}
            <div id="downloads" class="optionData">
                <h2 class="header">Downloads</h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Format">Format
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Format', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Format', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="File">File
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="bngl">
                                <td data-label="Format" class="Format">BNGL</td>
                                <td data-label="File" class="File"><span id="bnglFile" class="unit"></span>
                                </td>
                            </tr>
                            <tr id="m">
                                <td data-label="Format" class="Format">Metlab</td>
                                <td data-label="File" class="File"><span id="sbmlFile" class="unit"></span>
                                </td>
                            </tr>
                            <tr id="sbml">
                                <td data-label="Format" class="Format">SBML</td>
                                <td data-label="File" class="File"><span id="metlabFile" class="unit"></span></td>
                            </tr>
                            <tr id="xml">
                                <td data-label="Format" class="Format">Formatted XML</td>
                                <td data-label="File" class="File"><span id="fxmlFile" class="unit"></span>
                                </td>
                            </tr>
                            <tr id="SEDML">
                                <td data-label="Format" class="Format">SEDML</td>
                                <td data-label="File" class="File"><span id="sedmlFile" class="unit"></span>
                                </td>
                            </tr>
                            <tr id="deterministicXml">
                                <td data-label="Format" class="Format">Deterministic XML</td>
                                <td data-label="File" class="File"><span id="dxmlFile" class="unit"></span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>



<script>
    //script for graphics

    //defining string rgb values by hashing them
    Object.defineProperty(String.prototype, 'rgb', {
      //hashing string
      value: function() {
        var hash = 0, i, chr;
        for (var i = 0; i < this.length; i++) {
          chr   = this.charCodeAt(i);
          hash = (chr << (6 * i)) + hash;
          hash |= 0; // Convert to 32bit integer
        }
        //changing hash into rgb format:
        if (hash < 0) {
          hash *= -1;
        }
        if (hash < 65280) {
          hash++;
          hash *= 17777777;
        }
        //16777215 is 255 in base 10
        while (hash > 16777215) {
          hash = hash / 16;
        }
        color = Math.floor(hash);
        color = color.toString(16);
        var rgb = [];
        for (var i = 0; i < 3; i++) {
          rgb.push(parseInt(color.slice(i, 2 + i), 16));
        }
        //correcting colors too dark
        if (rgb.reduce((a, b) => a + b, 0) < 600) {
          const buff = 255 - Math.max(rgb[0], rgb[1], rgb[2]);
          for (var i = 0; i < 3; i++) {
            rgb[i] = rgb[i] + buff;
          }
          color = '';
          for (var i = 0; i < 3; i++) {
            color += rgb[i].toString(16);
          }
        }
        return (color);
      }
    });

    //splits string at target character;
    function splitString(string, target) {
      list = [];
      lastTagert = 0;
      for (var i = 0; i < string.length; i++) {
        if (string[i] == target) {
          list.push(string.slice(lastTagert, i));
          lastTagert = i + 1;
        }
      }
      list.push(string.slice(lastTagert, string.length));
      return(list);
    }

    //to do for graphics:
    //variable canvas dimensions
    //capacity for more than 1 bond
    //label bonds
    //class for molecules
    class Molecule {
      constructor(def) {
        //bionetgen definition
        this.def = def;
        //6 digit rgb hex
        this.color = '';
        //name of molecule
        this.name = '';
        //this.sites is an object, keys: site names, values: list of state names
        //this.sites, color, name initialized in process()
        this.process();
        //colors used to draw states
        this.stateColors = ['#FBC6D0', '#00FDFF', '#FA26A0', '#99F3BD'];
        //object, keys: bond names, values: x,y pair of pt to draw bond
        this.bonds = new Object();
      }

      //initialize this.color, sites, name from bionetgen def
      process() {
        //notice bond info is kept in this.sites and removed later
        var temp = splitString(this.def, '(');
        this.name = temp[0];
        this.color = this.name.rgb();
        var sites = temp[1].slice(0, -1);
        sites = splitString(sites, ',');
        var vkPairs = [];
        var temp = '';
        for (var i = 0; i < sites.length; i++) {
          if (sites[i].includes('~')) {
            //if sites have states
            temp = splitString(sites[i], '~');
            vkPairs.push([temp[0], temp.slice(1)]);
          } else if (sites[i].length != 0) {
            //if there are sites but no states
            vkPairs.push([sites[i], []]);
          } else {
            //if there are no sites
            vkPairs = null;
          }
        }
        if (vkPairs == null) {
          this.sites = Object();
        } else {
          this.sites = Object.fromEntries(vkPairs);
        }
      }

      //draw rounded rect
      drawRoundRect(canvasID, x, y, radius, length, rgb) {
        var canvas = document.getElementById(canvasID);
        var ctx = canvas.getContext('2d');
        ctx.fillStyle = '#' + rgb;
        ctx.beginPath();
        ctx.arc(x + radius, y + radius, radius, Math.PI / 2, Math.PI * (3/2));
        ctx.arc(x + radius + length, y + radius, radius, Math.PI * (3/2), Math.PI / 2);
        ctx.lineTo(x + radius, y + 2 * radius);
        ctx.fill();
        ctx.fillStyle = '#000000';
        ctx.stroke();
        ctx.closePath();
      }

      //draw bionetgen sites with states labeled
      drawSitesComplex(canvasID, x, y, radius) {
        var canvas = document.getElementById(canvasID);
        var ctx = canvas.getContext('2d');
        const siteRadius = 8;
        var siteLength = 0;
        var stateLength = 0;
        var longestState = 0;
        const keys = Object.keys(this.sites);
        //removing bond info from site name
        var siteNames = [];
        for (var i = 0; i < keys.length; i++) {
          siteNames.push(splitString(keys[i], '!')[0]);
        }
        var dx = radius - 2 * siteRadius;
        for (var i = 0; i < keys.length; i++) {
          //bottom line of sites
          var dy = 2 * radius + 2;
          dx = dx + 2 * siteRadius + siteLength;
          if (longestState > 2 * siteRadius + siteLength) {
            dx = dx - siteLength + longestState - 2 * siteRadius;
          }
          //add bonds if necessary
          if (keys[i].includes('!')) {
            this.bonds[keys[i]] = [x + dx, y + dy + siteRadius];
          }
          //drawing sites
          siteLength = 4.2 * siteNames[i].length;
          this.drawRoundRect(canvasID, x + dx - radius / 2, y + dy - radius / 2, siteRadius, siteLength, siteNames[i].rgb());
          //drawing site names
          ctx.fillStyle = '#000000';
          ctx.font = "12px Arial";
          ctx.fillText(siteNames[i], x + dx - siteRadius / 2, y + dy + siteRadius / 2 + 1);
          //drawing states of sites
          var states = this.sites[keys[i]];
          for (var u = 0; u < states.length; u++) {
            var sx = x + dx - siteRadius + 2;
            var sy = y + dy + u * 13 + siteRadius;
            //fix lengths
            stateLength = this.sites[keys[i]][u].length * 10;
            if (stateLength == 10) {
              stateLength = 15;
            }
            if (longestState < stateLength) {longestState = stateLength;}
            var colorIndex = u;
            if (colorIndex > 3) {colorIndex = colorIndex % 3;}
            ctx.fillStyle = this.stateColors[colorIndex];
            ctx.beginPath();
            ctx.rect(sx, sy, stateLength, 13);
            ctx.fill();
            ctx.fillStyle = '#000000';
            ctx.stroke();
            ctx.closePath();
            //naming sites
            ctx.fillStyle = '#000000';
            ctx.fillText(this.sites[keys[i]][u], sx + 3, sy + 11);
          }
        }
        //return total length of sites to compare to default length
        return(dx - x + radius);
      }

      //draw molecule with states and sites labled
      drawComplex(canvasID, x, y) {
        var canvas = document.getElementById(canvasID);
        var ctx = canvas.getContext('2d');
        const radius = 15;
        var length = 8 * this.name.length - radius / 2;
        if (length < 0) {length *= -1;}
        //notice drawSitesComplex() is called twice
        //this is a bad implementation but it doesn't effect runtime noticably
        var siteLength = this.drawSitesComplex(canvasID, x, y, radius);
        if (length < siteLength) {
          length = siteLength;
        }
        //drawing pill shape
        this.drawRoundRect(canvasID, x, y, radius, length, this.color);
        //drawing sites
        this.drawSitesComplex(canvasID, x, y, radius);
        //drawing name
        ctx.fillStyle = '#000000';
        ctx.font = "15px Arial";
        ctx.fillText(this.name, x + radius / 2, y + radius + 5);
        //return length of molecule for Graphic class
        return (radius * 2 + length);
      }
    }


    //each bionetgen should have own Graphic instance
    class Graphic {
      constructor(def) {
        //bionetgen definition
        this.def = def;
        //list of instances of molecule classes
        this.molecules = [];
        //initializing this.molecules
        this.process();
      }

      process() {
        var defs = splitString(this.def, '.');
        for (var i = 0; i < defs.length; i++) {
          this.molecules.push(new Molecule(defs[i]));
        }
      }

      //only works for species with two molecules or less, fix this
      draw(canvasID, x, y) {
        var length = 0;
        var pairs = [];
        var bondName = '';
        var bondNames = [];
        //drawing the graphics on the canvas
        var canvas = document.getElementById(canvasID);
        if (canvas.getContext) {
          var ctx = canvas.getContext('2d');
          //extracting bonds
          for (var i = 0; i < this.molecules.length; i++) {
            //drawing molecules without bonds
            length = this.molecules[i].drawComplex(canvasID, 2 + length, 2);
            bondNames = Object.keys(this.molecules[i].bonds);
            for (var g = 0; g < bondNames.length; g++) {
              bondName = bondNames[g];
              for (var u = 0; u < this.molecules.length; u++) {
                if (u != i) {
                  if (bondName in this.molecules[u].bonds) {
                    pairs.push([this.molecules[u].bonds[bondName], this.molecules[i].bonds[bondName]]);
                  }
                }
              }
            }
          }
          //drawing bonds
          for (var i = 0; i < pairs.length; i++) {
            ctx.beginPath();
            ctx.moveTo(pairs[i][0][0], pairs[i][0][1]);
            ctx.lineTo(pairs[i][0][0], pairs[i][0][1] + 5 * i + 5);
            ctx.lineTo(pairs[i][1][0], pairs[i][1][1] + 5 * i + 5);
            ctx.lineTo(pairs[i][1][0], pairs[i][1][1]);
            ctx.stroke();
          }
        } else {/*canvas-unsupported code here*/}
      }
    }

    //displaying graphics in species
    var speciesTable = document.getElementById('content-table3-species');
    var rowsLen = speciesTable.rows.length;
    var cellsLen = speciesTable.rows.item(1).cells.length;

    for (y = 1; y < rowsLen; y++) {
      var CanvasHTML = speciesTable.rows.item(y).cells.item(3).innerHTML;
      var bioNetGen = speciesTable.rows.item(y).cells.item(2).innerHTML;
      bioNetGen = bioNetGen.slice(0, bioNetGen.length - 1);
      speciesTable.rows.item(y).cells.item(2).innerHTML = bioNetGen;
      var start = 0;

      while (CanvasHTML[start] !== '""' && CanvasHTML[start - 1] !== "=") {start++;}
      var index = start + 1;
      while (CanvasHTML[index] !== '"') {index++;}

      CanvasHTML = CanvasHTML.slice(start + 1, index);
      if (bioNetGen.includes('!-')) {
        bioNetGen = bioNetGen.replace('!-', '');
        speciesTable.rows.item(y).cells.item(2).innerHTML = bioNetGen;
      }
      //var g = new Graphic('E(mod~U!2,e0!3,e1!1,e3!1.R(r0!2,r1!3))');
      var g = new Graphic(bioNetGen);
      g.draw(CanvasHTML, 0, 0);
    }

    //displaying graphics in molecules
    var moleculesTable = document.getElementById('content-table3-molecules');
    var rowsLen = moleculesTable.rows.length;
    var cellsLen = moleculesTable.rows.item(1).cells.length;

    for (y = 1; y < rowsLen; y++) {
      var CanvasHTML = moleculesTable.rows.item(y).cells.item(2).innerHTML;
      var bioNetGen = moleculesTable.rows.item(y).cells.item(1).innerHTML;
      var start = 0;

      while (CanvasHTML[start] !== '""' && CanvasHTML[start - 1] !== "=") {start++;}
      var index = start + 1;
      while (CanvasHTML[index] !== '"') {index++;}

      CanvasHTML = CanvasHTML.slice(start + 1, index);
      var m = new Molecule(bioNetGen);
      m.drawComplex(CanvasHTML, 1, 1);
    }


    //displaying graphics in observables
    var observablesTable = document.getElementById('content-table3-observables');
    var rowsLen = speciesTable.rows.length;
    var cellsLen = speciesTable.rows.item(1).cells.length;

    for (y = 1; y < rowsLen; y++) {
      var CanvasHTML = observablesTable.rows.item(y).cells.item(5).innerHTML;
      var bioNetGen = observablesTable.rows.item(y).cells.item(3).innerHTML;
      bioNetGen = bioNetGen.slice(0, bioNetGen.length - 1);
      observablesTable.rows.item(y).cells.item(2).innerHTML = bioNetGen;
      var start = 0;

      while (CanvasHTML[start] !== '""' && CanvasHTML[start - 1] !== "=") {start++;}
      var index = start + 1;
      while (CanvasHTML[index] !== '"') {index++;}

      CanvasHTML = CanvasHTML.slice(start + 1, index);
      if (bioNetGen.includes('!-')) {
        bioNetGen = bioNetGen.replace('!-', '');
        speciesTable.rows.item(y).cells.item(2).innerHTML = bioNetGen;
      }
      if (bioNetGen.length != 0) {
        var g = new Graphic(bioNetGen);
        g.draw(CanvasHTML, 0, 0);
      }
    }


    //displaying electrical for only membrane compartments
    var table = document.getElementById('TEST');
    var cells = table.rows.item(1).cells;
    if (cells.item(1).innerHTML != 'Membrane'){
      cells.item(2).innerHTML = 'N/A';
    }

    // making the first popup visible
    var firstPopup = document.querySelector(".popup").firstChild;
    firstPopup.parentElement.classList.add("firstPopup");


    // Open popup
    var open = 1;
    function reply_click(clicked_id) {
        if (open == 1) {
            $(".popup").css("opacity", 0);
            $(".overlay").css("opacity", 0);
            $(".popup").css("display", "none");
            $(".overlay").css("display", "none");
        }
        $(`.box-${clicked_id}`).css("opacity", 1);
        $(".overlay").css("opacity", 0.8);
        $(`.box-${clicked_id}`).css("display", "block");
        $(".overlay").css("display", "block");
        open = 1;
    };
    // close popup
    $(".popup-close").click(function () {
        open = 0;
        $(".popup").css("opacity", 0);
        $(".overlay").css("opacity", 0);
        setTimeout(function () {
            $(".popup").css("display", "none");
            $(".overlay").css("display", "none");
        }, 1000);
    });

</script>

<script src="/js/main.js"></script>

<script>
    alerting = (variable) => {
        console.log("alert is on");
        console.log(variable);
    };
</script>
